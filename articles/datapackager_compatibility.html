<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DataPackageR Compatibility • DPR2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DataPackageR Compatibility">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPR2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction_to_dpr2.html">Introduction to DPR2</a></li>
    <li><a class="dropdown-item" href="../articles/the_dpr2_workflow.html">The DPR2 Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/data_documentation.html">Data Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/data_versioning.html">Data Versioning</a></li>
    <li><a class="dropdown-item" href="../articles/datapackager_compatibility.html">DataPackageR Compatibility</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DataPackageR Compatibility</h1>
            
      

      <div class="d-none name"><code>datapackager_compatibility.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="converting-a-datapackager-data-package-to-use-dpr2">Converting a DataPackageR data package to use DPR2<a class="anchor" aria-label="anchor" href="#converting-a-datapackager-data-package-to-use-dpr2"></a>
</h2>
<p>Sometimes users may encounter datapackages created by DataPackageR.
DPR2 has the function <code>dpr_convert</code> which converts a
DataPackageR package into a DPR2 package. In this example we will copy
our DataPackageR test package to a temp directory to demonstrate the
DPR2 conversion function.</p>
<p>To convert a DataPackageR package to use DPR2 simply run
<code>dpr_convert(path)</code>, setting the path to the DataPackageR
package, with the default path being the current working directory.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load DPR2 </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fredhutch.github.io/DPR2/">DPR2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## convert DataPackageR package to the DPR2 format </span></span>
<span><span class="fu"><a href="../reference/dpr_convert.html">dpr_convert</a></span><span class="op">(</span><span class="va">dpr1_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in dpr1_data_digest_convert(path): Object `mtcars_mod` in data</span></span>
<span><span class="co">#&gt; directory does not match md5 not found in DATADIGEST.</span></span></code></pre></div>
<p>This conversion does data digest validation, where in the above
example, one of the tracked files has a different checksum than what is
reported in the digest.</p>
<p>Converting a package using <code><a href="../reference/dpr_convert.html">dpr_convert()</a></code> deletes several
files created by DataPackageR that DPR2 does not use:</p>
<ul>
<li><code>DATADIGEST</code></li>
<li><code>NEWS.md</code></li>
<li>
<code>Read-and-delete-me</code>,</li>
<li><code>R/documentation.R</code></li>
<li>
<code>data-raw/documentation.R</code>,</li>
<li>
<code>inst/extdata/Logfiles</code>,</li>
<li>any file in <code>inst/doc</code> with the same name as an
<code>R</code> or <code>Rmd</code> file found in the
<code>data-raw</code> or<code>Logfiles</code>
</li>
</ul>
<p><code><a href="../reference/dpr_convert.html">dpr_convert()</a></code> also modifies the package’s DataPackageR
<code>DESCRIPTION</code> file, removing its <code>Date</code>, and
<code>DataVersion</code> fields.</p>
<p>Although the <code>DATADIGEST</code> file is deleted, DPR2 does
maintain that information, but uses a directory found in
<code>inst</code> to do so. DPR2 provides the
<code>dpr_data_digest</code> function for assembling the contents of the
new data digest format into a tabular object. See <a href="data_versioning.html">Data Versioning</a> for more information
regarding how to use the new data digest format.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## view the new data digest</span></span>
<span><span class="fu"><a href="../reference/dpr_data_digest.html">dpr_data_digest</a></span><span class="op">(</span><span class="va">dpr1_path</span><span class="op">)</span></span>
<span><span class="co">#&gt;             name                  data_digest_md5</span></span>
<span><span class="co">#&gt; 1       iris.rda d3c5d071001b61a9f6131d3004fd0988</span></span>
<span><span class="co">#&gt; 2 mtcars_mod.rda 155cae107fc1e8b0ef6d0c4819a3c6a1</span></span>
<span><span class="co">#&gt; 3      trees.rda 0c2f6ee08f10e6377f07512045a606d3</span></span></code></pre></div>
<p><code>dpr_convert</code> also translates the orginal
<code>DataPackageR</code> yaml file into a DPR2 compatible format.
Examining the <code>datapackager.yml</code> file, we see the yaml
configuration for the DataPackageR package is converted to DPR2
compatible settings.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## view the new yaml file</span></span>
<span><span class="fu"><a href="../reference/dpr_yaml_get.html">dpr_yaml_get</a></span><span class="op">(</span><span class="va">dpr1_path</span><span class="op">)</span></span>
<span><span class="co">#&gt; $source_data_directory</span></span>
<span><span class="co">#&gt; [1] "inst/extdata"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $purge_data_directory</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $process_directory</span></span>
<span><span class="co">#&gt; [1] "data-raw"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $render_on_build</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $render_env_mode</span></span>
<span><span class="co">#&gt; [1] "isolate"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $write_to_vignettes</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $write_data_docs</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $to_build_directory</span></span>
<span><span class="co">#&gt; [1] "inst/to_build"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $build_tarball</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $install_on_build</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $build_output</span></span>
<span><span class="co">#&gt; [1] "../"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $objects</span></span>
<span><span class="co">#&gt; [1] "iris"       "mtcars_mod"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $process_on_build</span></span>
<span><span class="co">#&gt; [1] "iris.R"   "mtcars.R"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $r_session_wait_timeout</span></span>
<span><span class="co">#&gt; [1] 3000</span></span></code></pre></div>
<p>DataPackageR used the <code>data-raw</code> directory to store data
processing scripts. DPR2 uses a new <code>processing</code> directory to
store those; however, this is configurable in the DPR2
<code>datapackager.yml</code> file, and thus converted data packages
have this set to the default DataPackageR <code>data-raw</code>
path.</p>
<p>DPR2 maintains the DataPackageR functions <code>project_path</code>,
<code>project_data_path</code> and <code>project_extdata_path</code> to
ensure compatibility with scripts written for DataPackageR, but they are
not recommended to use for new scripts as these functions may be removed
from future versions of DPR2. Many DataPackageR packages may use these,
so these have been maintained to ensure minimal changes are required to
those processing scripts to function in a DPR2 package.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
